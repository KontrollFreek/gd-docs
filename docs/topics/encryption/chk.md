---
aside: true
---
# CHK

CHK is a common parameter in requests, which is intended to improve security.
CHK is sent in request often as `chk`.

CHK is generated like so:

1. Take arbitrary amount of values.
2. Combine them and add *salt* if there is one.
3. Apply [SHA-1](https://en.wikipedia.org/wiki/SHA-1) hashing to combined values and get its hexdigest.
4. Apply [XOR-Cipher](/topics/encryption/xor.md) to the hexdigest with desired key.
5. [Base64](/topics/encryption/base64.md) encode the result.

CHK generator can be implemented like this:

<!-- tabs:start -->

### **Python**

```py
import base64
import hashlib  # sha1() lives there


def generate_chk(values: [int, str] = [], key: str = "", salt: str = "") -> str:
    values.append(salt)

    string = ("").join(map(str, values))  # assure "str" type and connect values

    hashed = hashlib.sha1(string.encode()).hexdigest()
    xored = xor_cipher(hashed, key)  # we discuss this one in encryption/xor
    final = base64.urlsafe_b64encode(xored.encode()).decode()

    return final
```

<!-- tabs:end -->

XOR keys can be found [here](/topics/encryption/xor.md#xor-keys).

Here is a list of CHK values and explanations on their generation:

## Download level

- LevelID
- Inc
- [RS](/topics/encryption/id.md#rs)
- AccountID
- [UDID](/topics/encryption/id.md#udid)
- [UUID](/topics/encryption/id.md#uuid)

## Upload level

- seed2

seed2 is generated from level data:

<!-- tabs:start -->

### **Pseudocode**

```plain
seed2 = ""
space = length of levelString / 50

for i in range 50:
    seed2 += levelString[space * i]
   
seed2 += "xI25fpAapCQg"
sha1 encode seed2
xor encrypt seed2 with key 41274
```

### **Python**

```py
def generate_upload_seed(data: str, chars: int = 50) -> str:
    # GD currently uses 50 characters for level upload seed
    if len(data) < chars:
        return data  # not enough data to generate
    step = len(data) // chars
    return data[::step][:chars]
```

<!-- tabs:end -->

## Upload list

- seed
  
Seed is generated by taking the listLevel and obtaining 50 characters the same way as for uploading a level (see above), then appending your account ID to it, then taking a SHA-1 hash of that, then XOR encrypting with the randomly generated `seed2` value and Base64 URL-Safe encoding it.

## Comment

- `userName`
- `comment`
- `levelID` (0 for Account Comments)
- `percent` (0 for Account Comments)
- Comment Type (0 for Level, 1 for Account)

## Multiplayer Comment

- `accountID`
- `comment`
- `gameID`
- `extra`

## Challenges

- Random Number

Random number consisting of *5* digits.

## Rewards

- Random Number

Random number consisting of *5* digits.

## Like

- Special (0 = Level, LevelID = Level Comment, CommentID = Other Comment)
- `itemID`
- `like`
- `type`
- [RS](/topics/encryption/id.md#rs)
- `accountID`
- [`udid`](/topics/encryption/id.md#udid)
- [`uuid`](/topics/encryption/id.md#uuid)

## Rate

- `levelID`
- `stars`
- [RS](/topics/encryption/id.md#rs)
- `accountID`
- [`udid`](/topics/encryption/id.md#udid)
- [`uuid`](/topics/encryption/id.md#uuid)

## User Profile

- `accountID`
- `coins`
- `demons`
- `stars`
- `coins`
- `iconType`
- `icon`
- `diamonds`
- `accIcon`
- `accShip`
- `accBall`
- `accBird`
- `accDark`
- `accRobot`
- `accGlow`
- `accSpider`
- `accExplosion`
- Length of `dinfo`
- `dinfow`
- `dinfog`
- `sinfo`
- `sinfod`
- `sinfog`

## Level Leaderboard

- `accountID`
- `levelID`
- `percent`
- Jumps
- [Seed](#seed)
- `s4`
- `s6`
- Unknown (always 1)
- `s9` - 5819
- `s10`
- [RS](/topics/encryption/id.md#rs)

### Seed

Seed for classic levels can be generated like this:

<!-- tabs:start -->

```py
def generate_classic_leaderboard_seed(
    jumps: int, percentage: int, seconds: int, has_played: bool = True
) -> int:

    return (
        1482 * (has_played + 1)
        + (jumps + 3991) * (percentage + 8354)
        + ((seconds + 4085) ** 2) - 50028039
    )
```

<!-- tabs:end -->

For platformer levels:

<!-- tabs:start -->

```py
def generatePlatformerHash(bestTime, bestPoints):
  number = (((bestTime + 7890) % 34567) * 601 + ((abs(bestPoints) + 3456) % 78901) * 967 + 94819) % 94433
  return ((number ^ number >> 16) * 829) % 77849
```

<!-- tabs:end -->
